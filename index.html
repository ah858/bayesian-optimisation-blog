<!DOCTYPE html>

<head>
	<title>Blog</title>
 	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css"/>
	<script src="https://d3js.org/d3.v6.js"></script>
	<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/math/5.4.0/math.js"></script> -->
  <script src="https://unpkg.com/mathjs@8.0.1/lib/browser/math.js"></script>

	<link href="style.css" rel="stylesheet" type="text/css">
</head>

<body>
<article class="pa3 pa3-ns">
  
  <h1 class="f3 f1-m f-headline-l">Bayesian optimisation</h1>



	<div class="mw9 center ph3-ns">
		<!-- <div class="cf"> <!-- ph2-ns ->
		    <div class="fl w-100 w-50-ns ph2 pv0"> <!-- No vertical padding ->
				<h2>Bayesian optimisation</h2>

				<ul>
					<li>TO-DO list</li>
					<li>Pick section titles</li>
					<li>Page (1) Fix margins (2) Responsive mobile layout</li>
					<li>Add viewbox support</li>
					<li>Make graphics reset possible</li>
					<li>Replace buttons with scroll event listeners (and add smoother transitions)</li>
					<li>Add 'days left' timer on graphics (and annotations)</li>
					<li>Show the score away from the highest point on the choice graphics</li>
				</ul>

				<p>We'll start off by introducing an archetypal problem setting for Bayesian Optimization, and show how the key elements of Bayesian Optimization can improve upon a naive approach.</p>

				<h2>The Problem</h2>

				<p>Imagine you're on the engineering design team for a Formula 1 car. The team lead decided it would be worth a try to add a new side-wing to the vehicle to improve its cornering speed. The length of the side-wing, however, can vary within regulation constraints: 5cm - 40cm. Your job is to find the length of the wing that gives optimal performance as measured by the top cornering speed the driver is able to achieve.</p>

				<p>This is a typical setting for Bayesian Optimization. We're trying to optimize an unknown objective function y(x) - the vehicle's on track performance as a function of the side-wing length. The objective function is expensive to evaluate: it takes a long period of time to test a new prototype, and manufacturing a prototype component is costly. Our goal is to pick the wing lengths to evaluate such that we find the optimal design in a limited number of steps.</p>

				<p>You can manufacture a wing prototype in about a day, and the driver can test it on the track reporting their best time to you. There are only 5 days until the next race, however, so you have limited time to find the best design.</p>

		    </div>
		    <div class="fl w-100 w-50-ns">
		    </div>
		</div> -->



		<div class="cf">
		    <div class="fl w-100 w-50-ns pv0">
		    	<h2>Bayesian optimisation</h2>

				<ul>
					<li>TO-DO list</li>
					<li>Pick section titles</li>
					<li>Page (1) Fix margins (2) Responsive mobile layout</li>
					<li>Add viewbox support</li>
					<li>Make graphics reset possible</li>
					<li>Replace buttons with scroll event listeners (and add smoother transitions)</li>
					<li>Add 'days left' timer on graphics (and annotations)</li>
					<li>Show the score away from the highest point on the choice graphics</li>
				</ul>

				<p>We'll start off by introducing an archetypal problem setting for Bayesian Optimization, and show how the key elements of Bayesian Optimization can improve upon a naive approach.</p>

				<h2>The Problem</h2>

				<p>Imagine you're on the engineering design team for a Formula 1 car. The team lead decided it would be worth a try to add a new side-wing to the vehicle to improve its cornering speed. The length of the side-wing, however, can vary within regulation constraints: 5cm - 40cm. Your job is to find the length of the wing that gives optimal performance as measured by the top cornering speed the driver is able to achieve.</p>

				<p>This is a typical setting for Bayesian Optimization. We're trying to optimize an unknown objective function y(x) - the vehicle's on track performance as a function of the side-wing length. The objective function is expensive to evaluate: it takes a long period of time to test a new prototype, and manufacturing a prototype component is costly. Our goal is to pick the wing lengths to evaluate such that we find the optimal design in a limited number of steps.</p>

				<p>You can manufacture a wing prototype in about a day, and the driver can test it on the track reporting their best time to you. There are only 5 days until the next race, however, so you have limited time to find the best design.</p>
		    </div>
		</div>

		<!-- POSSIBLE FUNCTIONS -->

		<!-- <div class="cf">
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<h2>Possible functions</h2>
		    </div>
		</div>

		<div class="cf"> <!-- ph2-ns ->
		    <div class="fl w-100 w-50-ns ph2 pv0"> <!-- No vertical padding ->
				<p>The problem is that we don't know what wing lengths correspond to the best speeds. <strong>Hover tap over the graph on the right to see what possible relationships could look like.</strong></p>
		    </div>
		    <div class="fl w-100 w-50-ns">
		    	<div id="chart-possible-funcs"></div>
		    </div>
		</div> -->

		<div class="cf">
		    <div class="fl w-100 w-50-ns pv0">
				<h2>Possible functions</h2>
				<p>The problem is that we don't know what wing lengths correspond to the best speeds. <strong>Hover tap over the graph on the right to see what possible relationships could look like.</strong></p>
		    	<div id="chart-possible-funcs"></div>
		    	<h2>Choosing points blindly</h2>
		    	<p>Now let's look at the real data. Without knowing the function, can you find the optimal side wing in 5 days?
		    	
		    </div>
		</div>
		    

		<!-- BLIND CHOICE OF POINTS -->
<!-- <div class="cf">
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<h2>Choosing points blindly</h2>
		    </div>
		</div> -->

		<!-- <div class="cf"> <!-- ph2-ns ->
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<p>Now let's look at the real data. Without knowing the function, can you find the optimal side wing in 5 days?</p>
		    </div> <!-- No vertical padding ->
		    <div class="fl w-100 w-50-ns">
<!-- 		    	<div id="chart-choose-points-blind"></div>
 ->		    </div>
		</div>-->

		<div class="cf">
		    <div class="fl w-100 w-50-ns pv0">
		    	<div id="chart-choose-points-blind"></div>
		    	 </div>

		    <div class="fl w-100 w-50-ns ph6 pv5">
		    	<p class="i f6">We'll pick a new underlying function for you on each reset, we don't want to make it too easy.</p>
		   		<!-- <a class="f6 link dim br-pill ba ph3 pv1 dib black" href="#0">Play again</a> -->
		    </div>
		</div>

		<!-- MEAN ONLY CHOICE OF POINTS -->

		<div class="cf">
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<h2>Adding a model</h2>
		    </div>
		</div>

		<div class="cf"> <!-- ph2-ns -->
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<p>There are multiple ways of approach picking which points to evaluate. We could try naively picking the points at random, or divide the design-space uniformly and perform grid-search. With either of these approaches, however, we're ignoring the information we get back from the experiment. We want to utilise the information about which inputs turned out to be good, and which ones turned out to be bad, to focus our search on the most prospective areas of the design space.</p>

				<p>Instead of just picking side-wing lengths blindly, the central idea of Bayesian optimization is to fit a model to the data. This would allow us to predict what the objective (driver's track time) might be for side-wing lengths we haven't tested yet.</p>

				<p>Using this new model, we have clearer strategy of picking the most promising points: we can simply pick the side-wing that leads to the highest speed in the model.</p>

				<p>From these, we could pick the most promising points to test in practice.</p>

				<p>For instance, we could pick the best design as predicted by the model as the next one to test, i.e. the one that gives us the shortest predicted lap-time.</p>

		    	<div id="chart-choose-points-with-mean"></div>
		    </div> <!-- No vertical padding -->
		    <div class="fl w-100 w-50-ns">
		    	<!-- <div id="chart-choose-points-with-mean"></div> -->
		    </div>
		</div>

		<!-- EXPLAIN ISSUE WITH MEAN ALONE -->

		<div class="cf">
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<h2>Explore vs exploit</h2>
		    </div>
		</div>

		<div class="cf"> <!-- ph2-ns -->
		    <div class="fl w-100 w-50-ns ph2 pv0">

		    	<p>There is one issue with the approach outlined above.</p>

				<p>Look at the graphic on the right. If we pick the best point that is predicted by the model, we end up choosing a point that is close to existing points we have already found.</p>

				<button id="button-explore-exploit-1">Pick naive point</button>

				<p>This means that we have ignored the unexplored region of the search space (of smaller wing spans) where an even better design could be located.</p>

		    	<h2>Exploring uncertainty</h2>

		    	<p>It should be clear that this trade-off between selecting points close to 'best' points observed so far (exploiting) and traversing the design-space in search of better points (exploring) plays a central role in Bayesian Optimization.</p>

				<p>How do we know where to explore? We only want to explore in areas where there is a relatively large potential of observing a value that could be optimal, i.e. in those areas where our predictor is uncertain. Hence, in order to explore effectively we need estimates of uncertainty from the predictive model that we're using.</p> 

				<button id="button-explore-exploit-2">Show variance</button>

				<p>Our goal is to build a statistical picture of the functionâ€™s overall form given our observations of it. One convenient approach to modelling functions over continuous domains that allows for a full Bayesian Treatment are Gaussian Process. These are widely used in the Bayesian Optimization literature in applications.</p>

				<button id="button-explore-exploit-3">Show true function</button>

		    </div> <!-- No vertical padding -->
		    <div class="fl w-100 w-50-ns">
		    	<div id="chart-explore-exploit"></div>
			</div>
		</div>


		<!-- MEAN and VARIANCE CHOICE OF POINTS -->

		<div class="cf">
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<h2>Exploring uncertainty</h2>
		    </div>
		</div>


		<div class="cf"> <!-- ph2-ns -->
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<p>Picking the next point</p>

		    </div> <!-- No vertical padding -->
		    <div class="fl w-100 w-50-ns">
		    	<div id="chart-choose-points-with-variance"></div>
		    </div>
		</div>


		<!-- SANDOX GAUSSIAN -->


		<div class="cf">
		    <div class="fl w-100 w-50-ns ph2 pv0">
		    	<h2>Later blog sections</h2>
		    </div>
		</div>

		<div class="cf"> <!-- ph2-ns -->
		    <div class="fl w-100 w-50-ns ph2 pv0"> <!-- No vertical padding -->
				<button id="button1">Expected improvement</button>
		    </div>
		    <div class="fl w-100 w-50-ns">
		    	<div id="chart-gp-sandox"></div>
		    </div>
		</div>


		<div class="cf"> <!-- ph2-ns -->
		    <div class="fl w-100 w-50-ns ph2 pv0"></div> <!-- No vertical padding -->
		    <div class="fl w-100 w-50-ns"></div>
		</div>


		<div class="cf"> <!-- ph2-ns -->
		    <div class="fl w-100 w-50-ns ph2 pv0"></div> <!-- No vertical padding -->
		    <div class="fl w-100 w-50-ns"></div>
		</div>

	</div>

	<script src="./js/shared-chart-parameters.js"></script>	
	<script src="./js/chart-possible-funcs.js"></script>
	<script src="./js/chart-choose-points-blind.js"></script>	
	<script src="./js/chart-choose-points-with-mean.js"></script>
	<script src="./js/chart-explore-exploit.js"></script>		
	<script src="./js/chart-choose-points-with-variance.js"></script>		
	<script src="./js/chart-gp-sandox.js"></script>
        
</article>


	<!-- <h1>Bayseian optimisation</h1>

	<div class="container">

		<div class="col">
			<p>This is the first text</p>

			<p>This is the second text</p>
		</div>div>

		<div class="col">

			<svg id="dataviz_area" height=200 width=450></svg>

		</div>div>

	</div> -->

</body>
